INSERT INTO PLAYLIST_MOVIE_HISTORIC (
    ID_MOVIE,
    TITLE,
    "description",
    VIEWS,
    LIKES,
    LIVE,
    keywords,
    available_countries,
    CATEGORY,
    FAMILY_FRIENDLY,
    DT_UPLOAD,
    DT_PUBLISH,
    DT_START,
    DT_END
) VALUES (
    {{ ID_MOVIE }},
    '{{ TITLE }}',
    '{{ DESCRIPTION }}',
    {{ VIEWS }},
    {{ LIKES }},
    {{ LIVE }},
    ARRAY[{{ KEYWORDS }}],
    ARRAY[{{ AVAILABLE_COUNTRIES }}],
    '{{ CATEGORY }}',
    '{{ FAMILY_FRIENDLY }}',
    '{{ DT_UPLOAD }}',
    '{{ DT_PUBLISH }}',
    '{{ DT_START }}',
    '{{ DT_END }}'
)
ON CONFLICT (ID_MOVIE, DT_END) DO UPDATE SET
    TITLE = EXCLUDED.TITLE,
    "description" = EXCLUDED."description",
    VIEWS = EXCLUDED.VIEWS,
    LIKES = EXCLUDED.LIKES,
    LIVE = EXCLUDED.LIVE,
    keywords = EXCLUDED.keywords,
    available_countries = EXCLUDED.available_countries,
    CATEGORY = EXCLUDED.CATEGORY,
    FAMILY_FRIENDLY = EXCLUDED.FAMILY_FRIENDLY,
    DT_UPLOAD = EXCLUDED.DT_UPLOAD,
    DT_PUBLISH = EXCLUDED.DT_PUBLISH,
    DT_START = EXCLUDED.DT_START,
    DT_END = EXCLUDED.DT_END
    -- TITLE = COALESCE(EXCLUDED.TITLE, PLAYLIST_MOVIE_HISTORIC.TITLE),
    -- "description" = COALESCE(EXCLUDED."description", PLAYLIST_MOVIE_HISTORIC."description"),
    -- VIEWS = COALESCE(EXCLUDED.VIEWS, PLAYLIST_MOVIE_HISTORIC.VIEWS),
    -- LIKES = COALESCE(EXCLUDED.LIKES, PLAYLIST_MOVIE_HISTORIC.LIKES),
    -- LIVE = COALESCE(EXCLUDED.LIVE, PLAYLIST_MOVIE_HISTORIC.LIVE),
    -- keywords = COALESCE(EXCLUDED.keywords, PLAYLIST_MOVIE_HISTORIC.keywords),
    -- available_countries = COALESCE(EXCLUDED.available_countries, PLAYLIST_MOVIE_HISTORIC.available_countries),
    -- CATEGORY = COALESCE(EXCLUDED.CATEGORY, PLAYLIST_MOVIE_HISTORIC.CATEGORY),
    -- FAMILY_FRIENDLY = COALESCE(EXCLUDED.FAMILY_FRIENDLY, PLAYLIST_MOVIE_HISTORIC.FAMILY_FRIENDLY),
    -- DT_UPLOAD = COALESCE(EXCLUDED.DT_UPLOAD, PLAYLIST_MOVIE_HISTORIC.DT_UPLOAD),
    -- DT_PUBLISH = COALESCE(EXCLUDED.DT_PUBLISH, PLAYLIST_MOVIE_HISTORIC.DT_PUBLISH),
    -- DT_START = COALESCE(EXCLUDED.DT_START, PLAYLIST_MOVIE_HISTORIC.DT_START),
    -- DT_END = COALESCE(EXCLUDED.DT_END, PLAYLIST_MOVIE_HISTORIC.DT_END)